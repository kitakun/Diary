@model Kitakun.TagDiary.Core.Domain.DiaryRecord;
@using Kitakun.TagDiary.Web.Extensions;
@{
    ViewData["Title"] = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<div class="row">
    @if (Model.ProtectedByPassword)
    {
        <div class="col-10">
            <h3>@Model.ShortDescription</h3>
        </div>
        <div class="col-2">
            @using (Html.BeginForm(
            nameof(Kitakun.TagDiary.Web.Controllers.DiaryRecordController.Index),
            ControllerExtensions.GetControllerName<Kitakun.TagDiary.Web.Controllers.DiaryRecordController>(),
            FormMethod.Post,
            htmlAttributes: new { @id = "createNewDiaryForm" }))
            {
                @Html.HiddenFor(x => x.TokenUrl)
                <input type="password" name="password" class="form-control" placeholder="Password" />
            }
        </div>
    }
    else
    {
        <h3>@Model.ShortDescription</h3>
    }

    <div class="col-12">
        <div id="textContent" style="display:none">
            @Model.MarkdownText
        </div>
        <div id="fullMarkdown">

        </div>
    </div>
</div>

<script type="text/javascript">
    document.addEventListener('DOMContentLoaded', function () {
        $(document).ready(function () {
            var quill = new Quill('#fullMarkdown', {
                modules: {
                        toolbar: false
                },
                readOnly: true,
                theme: 'snow'
            });
            quill.setContents(JSON.parse(document.getElementById('textContent').innerHTML));

            insertParam('recordKey', '@Model.TokenUrl');
        });
    });
</script>

